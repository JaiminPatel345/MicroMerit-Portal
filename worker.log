[2025-12-08T12:16:54.288Z] [INFO] Prisma Client initialized
[2025-12-08T12:16:54.467Z] [INFO] Credential processing worker started (concurrency: 5)
[2025-12-08T12:16:54.485Z] [INFO] Redis connected successfully
[2025-12-08T12:17:45.029Z] [INFO] Processing job nsdc:8:cred-a-001: nsdc credential
prisma:query SELECT "public"."ProcessedJob"."idempotency_key", "public"."ProcessedJob"."processed_at" FROM "public"."ProcessedJob" WHERE ("public"."ProcessedJob"."idempotency_key" = $1 AND 1=1) LIMIT $2 OFFSET $3
[2025-12-08T12:17:45.205Z] [WARN] Production KMS not configured, falling back to dev mock
prisma:query SELECT "public"."issuer"."id", "public"."issuer"."name", "public"."issuer"."official_domain", "public"."issuer"."website_url", "public"."issuer"."type", "public"."issuer"."email", "public"."issuer"."phone", "public"."issuer"."password_hash", "public"."issuer"."contact_person_name", "public"."issuer"."contact_person_designation", "public"."issuer"."address", "public"."issuer"."kyc_document_url", "public"."issuer"."logo_url", "public"."issuer"."status", "public"."issuer"."approved_at", "public"."issuer"."rejected_reason", "public"."issuer"."is_blocked", "public"."issuer"."blocked_reason", "public"."issuer"."created_at", "public"."issuer"."registry_id", "public"."issuer"."last_sync_at", "public"."issuer"."accept_external", "public"."issuer"."reissue_local_vc" FROM "public"."issuer" WHERE "public"."issuer"."website_url"::text LIKE $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."learner"."id" FROM "public"."learner" WHERE ("public"."learner"."email" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query INSERT INTO "public"."Credential" ("id","credential_id","learner_id","learner_email","issuer_id","certificate_title","issued_at","data_hash","metadata","status","createdAt","updatedAt","is_external","provider_credential_id","signature_verified","verification_method","encrypted_raw_payload","match_confidence","processed_at") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19) RETURNING "public"."Credential"."id", "public"."Credential"."credential_id", "public"."Credential"."learner_id", "public"."Credential"."learner_email", "public"."Credential"."issuer_id", "public"."Credential"."certificate_title", "public"."Credential"."issued_at", "public"."Credential"."ipfs_cid", "public"."Credential"."pdf_url", "public"."Credential"."tx_hash", "public"."Credential"."data_hash", "public"."Credential"."metadata", "public"."Credential"."status", "public"."Credential"."createdAt", "public"."Credential"."updatedAt", "public"."Credential"."is_external", "public"."Credential"."provider_credential_id", "public"."Credential"."signature_verified", "public"."Credential"."verification_method", "public"."Credential"."encrypted_raw_payload", "public"."Credential"."match_confidence", "public"."Credential"."match_type", "public"."Credential"."processed_at"
prisma:query UPDATE "public"."issuer" SET "last_sync_at" = $1 WHERE ("public"."issuer"."id" = $2 AND 1=1) RETURNING "public"."issuer"."id", "public"."issuer"."name", "public"."issuer"."official_domain", "public"."issuer"."website_url", "public"."issuer"."type", "public"."issuer"."email", "public"."issuer"."phone", "public"."issuer"."password_hash", "public"."issuer"."contact_person_name", "public"."issuer"."contact_person_designation", "public"."issuer"."address", "public"."issuer"."kyc_document_url", "public"."issuer"."logo_url", "public"."issuer"."status", "public"."issuer"."approved_at", "public"."issuer"."rejected_reason", "public"."issuer"."is_blocked", "public"."issuer"."blocked_reason", "public"."issuer"."created_at", "public"."issuer"."registry_id", "public"."issuer"."last_sync_at", "public"."issuer"."accept_external", "public"."issuer"."reissue_local_vc"
prisma:query INSERT INTO "public"."ProcessedJob" ("idempotency_key","processed_at") VALUES ($1,$2) RETURNING "public"."ProcessedJob"."idempotency_key", "public"."ProcessedJob"."processed_at"
[2025-12-08T12:17:45.347Z] [INFO] ✓ External credential processed: 966e4b76-5e6f-476e-908d-a57ca769fa01
[2025-12-08T12:17:45.348Z] [INFO] ✓ Credential processed: 966e4b76-5e6f-476e-908d-a57ca769fa01
[2025-12-08T12:17:45.355Z] [INFO] Job nsdc:8:cred-a-001 completed
[2025-12-08T12:17:46.095Z] [INFO] Processing job nsdc:9:cred-b-001: nsdc credential
[2025-12-08T12:17:46.107Z] [INFO] Processing job nsdc:9:cred-b-002: nsdc credential
prisma:query SELECT "public"."ProcessedJob"."idempotency_key", "public"."ProcessedJob"."processed_at" FROM "public"."ProcessedJob" WHERE ("public"."ProcessedJob"."idempotency_key" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."ProcessedJob"."idempotency_key", "public"."ProcessedJob"."processed_at" FROM "public"."ProcessedJob" WHERE ("public"."ProcessedJob"."idempotency_key" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."learner"."id" FROM "public"."learner" WHERE "public"."learner"."phone"::text LIKE $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."learner"."id" FROM "public"."learner" WHERE ("public"."learner"."email" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query INSERT INTO "public"."Credential" ("id","credential_id","learner_id","learner_email","issuer_id","certificate_title","issued_at","data_hash","metadata","status","createdAt","updatedAt","is_external","provider_credential_id","signature_verified","verification_method","encrypted_raw_payload","match_confidence","processed_at") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19) RETURNING "public"."Credential"."id", "public"."Credential"."credential_id", "public"."Credential"."learner_id", "public"."Credential"."learner_email", "public"."Credential"."issuer_id", "public"."Credential"."certificate_title", "public"."Credential"."issued_at", "public"."Credential"."ipfs_cid", "public"."Credential"."pdf_url", "public"."Credential"."tx_hash", "public"."Credential"."data_hash", "public"."Credential"."metadata", "public"."Credential"."status", "public"."Credential"."createdAt", "public"."Credential"."updatedAt", "public"."Credential"."is_external", "public"."Credential"."provider_credential_id", "public"."Credential"."signature_verified", "public"."Credential"."verification_method", "public"."Credential"."encrypted_raw_payload", "public"."Credential"."match_confidence", "public"."Credential"."match_type", "public"."Credential"."processed_at"
prisma:query INSERT INTO "public"."Credential" ("id","credential_id","learner_id","learner_email","issuer_id","certificate_title","issued_at","data_hash","metadata","status","createdAt","updatedAt","is_external","provider_credential_id","signature_verified","verification_method","encrypted_raw_payload","match_confidence","processed_at") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19) RETURNING "public"."Credential"."id", "public"."Credential"."credential_id", "public"."Credential"."learner_id", "public"."Credential"."learner_email", "public"."Credential"."issuer_id", "public"."Credential"."certificate_title", "public"."Credential"."issued_at", "public"."Credential"."ipfs_cid", "public"."Credential"."pdf_url", "public"."Credential"."tx_hash", "public"."Credential"."data_hash", "public"."Credential"."metadata", "public"."Credential"."status", "public"."Credential"."createdAt", "public"."Credential"."updatedAt", "public"."Credential"."is_external", "public"."Credential"."provider_credential_id", "public"."Credential"."signature_verified", "public"."Credential"."verification_method", "public"."Credential"."encrypted_raw_payload", "public"."Credential"."match_confidence", "public"."Credential"."match_type", "public"."Credential"."processed_at"
prisma:query UPDATE "public"."issuer" SET "last_sync_at" = $1 WHERE ("public"."issuer"."id" = $2 AND 1=1) RETURNING "public"."issuer"."id", "public"."issuer"."name", "public"."issuer"."official_domain", "public"."issuer"."website_url", "public"."issuer"."type", "public"."issuer"."email", "public"."issuer"."phone", "public"."issuer"."password_hash", "public"."issuer"."contact_person_name", "public"."issuer"."contact_person_designation", "public"."issuer"."address", "public"."issuer"."kyc_document_url", "public"."issuer"."logo_url", "public"."issuer"."status", "public"."issuer"."approved_at", "public"."issuer"."rejected_reason", "public"."issuer"."is_blocked", "public"."issuer"."blocked_reason", "public"."issuer"."created_at", "public"."issuer"."registry_id", "public"."issuer"."last_sync_at", "public"."issuer"."accept_external", "public"."issuer"."reissue_local_vc"
prisma:query UPDATE "public"."issuer" SET "last_sync_at" = $1 WHERE ("public"."issuer"."id" = $2 AND 1=1) RETURNING "public"."issuer"."id", "public"."issuer"."name", "public"."issuer"."official_domain", "public"."issuer"."website_url", "public"."issuer"."type", "public"."issuer"."email", "public"."issuer"."phone", "public"."issuer"."password_hash", "public"."issuer"."contact_person_name", "public"."issuer"."contact_person_designation", "public"."issuer"."address[2025-12-08T12:17:50.179Z] [INFO] Processing job nsdc:8:cred-a-002: nsdc credential
prisma:query SELECT "public"."ProcessedJob"."idempotency_key", "public"."ProcessedJob"."processed_at" FROM "public"."ProcessedJob" WHERE ("public"."ProcessedJob"."idempotency_key" = $1 AND 1=1) LIMIT $2 OFFSET $3
[2025-12-08T12:17:50.213Z] [ERROR] Credential processing failed: | {}
prisma:query INSERT INTO "public"."DLQ" ("id","job_type","job_id","reason","attempts","payload","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."DLQ"."id", "public"."DLQ"."job_type", "public"."DLQ"."job_id", "public"."DLQ"."reason", "public"."DLQ"."attempts"[2025-12-08T12:18:00.335Z] [INFO] Processing job nsdc:8:cred-a-002: nsdc credential
prisma:query SELECT 1
prisma:query SELECT "public"."ProcessedJob"."idempotency_key", "public"."ProcessedJob"."processed_at" FROM "public"."ProcessedJob" WHERE ("public"."ProcessedJob"."idempotency_key" = $1 AND 1=1) LIMIT $2 OFFSET $3
[2025-12-08T12:18:00.347Z] [ERROR] Credential processing failed: | {}
prisma:query INSERT INTO "public"."DLQ" ("id","job_type","job_id","reason","attempts","payload","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."DLQ"."id", "public"."DLQ"."job_type", "public"."DLQ"."job_id", "public"."DLQ"."reason", "public"."DLQ"."attempts", "public"."DLQ"."payload", "public"."DLQ"."created_at"
[2025-12-08T12:18:00.366Z] [ERROR] Job nsdc:8:cred-a-002 failed: | {}
ELECT "public"."ProcessedJob"."idempotency_key", "public"."ProcessedJob"."processed_at" FROM "public"."ProcessedJob" WHERE ("public"."ProcessedJob"."idempotency_key" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."learner"."id" FROM "public"."learner" WHERE ("public"."learner"."email" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."learner"."id" FROM "public"."learner" WHERE "public"."learner"."other_emails" @> $1 LIMIT $2 OFFSET $3
prisma:query INSERT INTO "public"."Credential" ("id","credential_id","learner_id","learner_email","issuer_id","certificate_title","issued_at","data_hash","metadata","status","createdAt","updatedAt","is_external","provider_credential_id","signature_verified","verification_method","encrypted_raw_payload","match_confidence","processed_at") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19) RETURNING "public"."Credential"."id", "public"."Credential"."credential_id", "public"."Credential"."learner_id", "public"."Credential"."learner_email", "public"."Credential"."issuer_id", "public"."Credential"."certificate_title", "public"."Credential"."issued_at", "public"."Credential"."ipfs_cid", "public"."Credential"."pdf_url", "public"."Credential"."tx_hash", "public"."Credential"."data_hash", "public"."Credential"."metadata", "public"."Credential"."status", "public"."Credential"."createdAt", "public"."Credential"."updatedAt", "public"."Credential"."is_external", "public"."Credential"."provider_credential_id", "public"."Credential"."signature_verified", "public"."Credential"."verification_method", "public"."Credential"."encrypted_raw_payload", "public"."Credential"."match_confidence", "public"."Credential"."match_type", "public"."Credential"."processed_at"
prisma:query UPDATE "public"."issuer" SET "last_sync_at" = $1 WHERE ("public"."issuer"."id" = $2 AND 1=1) RETURNING "public"."issuer"."id", "public"."issuer"."name", "public"."issuer"."official_domain", "public"."issuer"."website_url", "public"."issuer"."type", "public"."issuer"."email", "public"."issuer"."phone", "public"."issuer"."password_hash", "public"."issuer"."contact_person_name", "public"."issuer"."contact_person_designation", "public"."issuer"."address", "public"."issuer"."kyc_document_url", "public"."issuer"."logo_url", "public"."issuer"."status", "public"."issuer"."approved_at", "public"."issuer"."rejected_reason", "public"."issuer"."is_blocked", "public"."issuer"."blocked_reason", "public"."issuer"."created_at", "public"."issuer"."registry_id", "public"."issuer"."last_sync_at", "public"."issuer"."accept_external", "public"."issuer"."reissue_local_vc"
prisma:query INSERT INTO "public"."ProcessedJob" ("idempotency_key","processed_at") VALUES ($1,$2) RETURNING "public"."ProcessedJob"."idempotency_key", "public"."ProcessedJob"."processed_at"
[2025-12-08T12:17:50.240Z] [INFO] ✓ External credential processed: 05a7331d-7b76-43be-9448-f2caec3e32b4
[2025-12-08T12:17:50.240Z] [INFO] ✓ Credential processed: 05a7331d-7b76-43be-9448-f2caec3e32b4
[2025-12-08T12:17:50.243Z] [INFO] Job nsdc:8:cred-a-003 completed
